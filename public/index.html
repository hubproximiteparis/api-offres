<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hub Proximit√© - Expert Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .app-icon { transition: all 0.2s ease; cursor: pointer; }
        .app-icon:active { transform: scale(0.9); }
        .grid-container { background: radial-gradient(circle, #f8fafc 0%, #e2e8f0 100%); }
        /* Style pour les sections d√©filantes sur mobile */
        .scroll-x { overflow-x: auto; white-space: nowrap; -webkit-overflow-scrolling: touch; }
    </style>
</head>
<body class="grid-container min-h-screen font-sans text-gray-900">

    <header class="p-6 pb-2">
        <div class="flex justify-between items-center mb-6">
            <div>
                <h1 class="text-2xl font-black text-indigo-900 tracking-tighter">HUB PROXIMIT√â</h1>
                <p class="text-[10px] text-gray-500 font-bold uppercase tracking-widest text-indigo-600">Plateforme Expert ‚Ä¢ v2.1</p>
            </div>
            <button onclick="changerOnglet('favoris')" class="bg-white p-3 rounded-2xl shadow-sm text-red-500">
                <i class="fas fa-heart"></i>
            </button>
        </div>

        <div id="search-section" class="bg-white p-4 rounded-3xl shadow-xl border border-white/50 mb-6">
            <div class="flex flex-col gap-3">
                <div class="relative">
                    <i class="fas fa-search absolute left-4 top-3.5 text-indigo-400"></i>
                    <input type="text" id="metier" placeholder="M√©tier ou Comp√©tence" class="w-full pl-12 pr-4 py-3 bg-gray-50 rounded-2xl outline-none focus:ring-2 focus:ring-indigo-500 font-medium text-sm">
                </div>
                <div class="flex gap-2">
                    <div class="relative flex-1">
                        <i class="fas fa-map-pin absolute left-4 top-3.5 text-red-400"></i>
                        <input type="text" id="ville" placeholder="Code Postal" class="w-full pl-12 pr-4 py-3 bg-gray-50 rounded-2xl outline-none focus:ring-2 focus:ring-indigo-500 font-medium text-sm">
                    </div>
                    <button onclick="rechercher()" class="bg-indigo-600 text-white px-6 rounded-2xl font-black shadow-lg shadow-indigo-200 uppercase text-xs">Scanner</button>
                </div>
            </div>
        </div>
    </header>

    <main class="px-6 pb-24">
        
        <h2 class="text-[10px] font-black text-gray-400 mb-3 tracking-widest uppercase italic">üöÄ Emploi & Opportunit√©s</h2>
        <div class="grid grid-cols-4 gap-4 mb-8">
            <div onclick="window.open('https://place-emploi-public.gouv.fr/', '_blank')" class="app-icon flex flex-col items-center">
                <div class="w-14 h-14 bg-blue-800 rounded-2xl shadow-lg flex items-center justify-center text-white text-xl"><i class="fas fa-landmark"></i></div>
                <span class="text-[9px] mt-2 font-bold text-center">F. Publique</span>
            </div>
            <div onclick="window.open('https://recrutement.aphp.fr/', '_blank')" class="app-icon flex flex-col items-center">
                <div class="w-14 h-14 bg-cyan-700 rounded-2xl shadow-lg flex items-center justify-center text-white text-xl"><i class="fas fa-hospital-user"></i></div>
                <span class="text-[9px] mt-2 font-bold text-center">AP-HP</span>
            </div>
            <div onclick="window.open('https://www.meteojob.com/', '_blank')" class="app-icon flex flex-col items-center">
                <div class="w-14 h-14 bg-orange-400 rounded-2xl shadow-lg flex items-center justify-center text-white text-xl"><i class="fas fa-cloud-sun-rain"></i></div>
                <span class="text-[9px] mt-2 font-bold text-center">Meteojob</span>
            </div>
            <div onclick="window.open('https://www.linkedin.com/', '_blank')" class="app-icon flex flex-col items-center">
                <div class="w-14 h-14 bg-blue-600 rounded-2xl shadow-lg flex items-center justify-center text-white text-xl"><i class="fab fa-linkedin-in"></i></div>
                <span class="text-[9px] mt-2 font-bold text-center">LinkedIn</span>
            </div>
        </div>

        <h2 class="text-[10px] font-black text-gray-400 mb-3 tracking-widest uppercase italic">ü©∫ Sant√© & Social</h2>
        <div class="grid grid-cols-4 gap-4 mb-8">
            <div onclick="window.open('https://www.doctolib.fr', '_blank')" class="app-icon flex flex-col items-center">
                <div class="w-14 h-14 bg-blue-500 rounded-2xl shadow-lg flex items-center justify-center text-white text-xl"><i class="fas fa-stethoscope"></i></div>
                <span class="text-[9px] mt-2 font-bold text-center">Doctolib</span>
            </div>
            <div onclick="window.open('https://www.demande-logement-social.gouv.fr/', '_blank')" class="app-icon flex flex-col items-center">
                <div class="w-14 h-14 bg-emerald-600 rounded-2xl shadow-lg flex items-center justify-center text-white text-xl"><i class="fas fa-key"></i></div>
                <span class="text-[9px] mt-2 font-bold text-center">HLM Social</span>
            </div>
            <div onclick="window.open('https://soliguide.fr/', '_blank')" class="app-icon flex flex-col items-center">
                <div class="w-14 h-14 bg-orange-500 rounded-2xl shadow-lg flex items-center justify-center text-white text-xl"><i class="fas fa-map-marker-alt"></i></div>
                <span class="text-[9px] mt-2 font-bold text-center">Soliguide</span>
            </div>
            <div onclick="window.open('https://www.entourage.social/', '_blank')" class="app-icon flex flex-col items-center">
                <div class="w-14 h-14 bg-red-500 rounded-2xl shadow-lg flex items-center justify-center text-white text-xl"><i class="fas fa-hand-holding-heart"></i></div>
                <span class="text-[9px] mt-2 font-bold text-center">Entourage</span>
            </div>
        </div>

        <h2 class="text-[10px] font-black text-gray-400 mb-3 tracking-widest uppercase italic">üìù Outils CV & Coaching</h2>
        <div class="grid grid-cols-4 gap-4 mb-8">
            <div onclick="window.open('https://cvdesignr.com/fr', '_blank')" class="app-icon flex flex-col items-center">
                <div class="w-14 h-14 bg-indigo-600 rounded-2xl shadow-lg flex items-center justify-center text-white text-xl"><i class="fas fa-file-invoice"></i></div>
                <span class="text-[9px] mt-2 font-bold text-center">CV Designr</span>
            </div>
            <div onclick="window.open('https://www.myjobglasses.com/', '_blank')" class="app-icon flex flex-col items-center">
                <div class="w-14 h-14 bg-fuchsia-600 rounded-2xl shadow-lg flex items-center justify-center text-white text-xl"><i class="fas fa-glasses"></i></div>
                <span class="text-[9px] mt-2 font-bold text-center">Glasses</span>
            </div>
            <div onclick="window.open('https://metiers-scope.frt.travail.gouv.fr/', '_blank')" class="app-icon flex flex-col items-center">
                <div class="w-14 h-14 bg-teal-500 rounded-2xl shadow-lg flex items-center justify-center text-white text-xl"><i class="fas fa-microscope"></i></div>
                <span class="text-[9px] mt-2 font-bold text-center">M. Scope</span>
            </div>
            <div onclick="window.open('https://www.canva.com', '_blank')" class="app-icon flex flex-col items-center">
                <div class="w-14 h-14 bg-cyan-400 rounded-2xl shadow-lg flex items-center justify-center text-white text-xl"><i class="fab fa-canva"></i></div>
                <span class="text-[9px] mt-2 font-bold text-center">Canva</span>
            </div>
        </div>

        <div id="resultats" class="grid grid-cols-1 gap-4"></div>
    </main>

    <script>
        // CONFIGURATION : Remplacez par votre URL Render
        const API_BASE_URL = "https://hub-proximite.onrender.com";

        async function rechercher() {
            const m = document.getElementById('metier').value;
            const v = document.getElementById('ville').value;
            const resZone = document.getElementById('resultats');

            if(!m) return alert("Saisissez un m√©tier (ex: Boulanger)");

            resZone.innerHTML = `<div class="p-10 text-center"><i class="fas fa-circle-notch fa-spin text-indigo-600 text-2xl"></i><p class="text-[10px] font-bold mt-2 text-gray-400 uppercase tracking-widest">Recherche en cours...</p></div>`;
            
            try {
                // Utilisation de l'URL absolue pour √©viter les bugs sur mobile
                const res = await fetch(`${API_BASE_URL}/api/search?metier=${encodeURIComponent(m)}&ville=${v}`);
                if (!res.ok) throw new Error('Erreur API');
                const offres = await res.json();
                afficher(offres);
            } catch (e) {
                console.error(e);
                resZone.innerHTML = `<p class="text-center text-red-500 font-bold p-4 bg-red-50 rounded-2xl">Erreur de connexion au serveur</p>`;
            }
        }

        function afficher(offres) {
            const resZone = document.getElementById('resultats');
            if(!offres || offres.length === 0) {
                resZone.innerHTML = `<p class="text-center py-10 text-gray-400 font-medium italic">Aucune offre trouv√©e.</p>`;
                return;
            }
            resZone.innerHTML = `
                <h2 class="text-[10px] font-black text-indigo-900 mb-4 tracking-widest uppercase">R√©sultats trouv√©s</h2>
                ${offres.map(o => `
                    <div class="bg-white p-5 rounded-3xl shadow-sm border border-gray-100 mb-4 transition-all active:scale-95">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="font-black text-indigo-900 text-[12px] uppercase leading-tight flex-1 pr-4">${o.intitule}</h3>
                            <span class="bg-indigo-100 text-indigo-700 text-[8px] px-2 py-1 rounded-lg font-black italic">NEW</span>
                        </div>
                        <p class="text-[11px] text-gray-500 font-bold mb-4">
                            <i class="fas fa-building mr-1 text-gray-300"></i> ${o.entreprise?.nom || 'Anonyme'} 
                            <span class="mx-2 text-gray-200">|</span>
                            <i class="fas fa-map-marker-alt mr-1 text-red-300"></i> ${o.lieuTravail?.libelle || 'Local'}
                        </p>
                        <a href="${o.origineOffre?.urlOrigine || o.url}" target="_blank" class="block w-full text-center py-4 bg-indigo-600 text-white rounded-2xl text-[10px] font-black uppercase tracking-widest shadow-lg shadow-indigo-100">Postuler maintenant</a>
                    </div>
                `).join('')}
            `;
            // Scroll automatique vers les r√©sultats
            resZone.scrollIntoView({ behavior: 'smooth' });
        }

        function changerOnglet(type) {
            if(type === 'favoris') {
                window.location.href = `${API_BASE_URL}/api/mes-favoris`;
            } else {
                location.reload();
            }
        }
    </script>
</body>
</html>